<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RailOps Dashboard</title>
  <link rel="stylesheet" href="static/css/ol.css">
  <style>
    html, body { margin: 0; padding: 0; height: 100%; }
    #map { width: 100%; height: 100vh; }
  </style>
</head>
<body>
  <div id="map"></div>

  <script src="static/js/ol.js"></script>
  <script>
    const trainsURL = "https://traintrackeroz.netlify.app/trains.json"; // Updated to use Netlify

    const map = new ol.Map({
      target: 'map',
      layers: [
        new ol.layer.Tile({
          source: new ol.source.OSM()
        })
      ],
      view: new ol.View({
        center: ol.proj.fromLonLat([133.7751, -25.2744]), // Center of Australia
        zoom: 5
      })
    });

    fetch(trainsURL)
      .then(res => res.json())
      .then(data => {
        data.forEach(train => {
          const feature = new ol.Feature({
            geometry: new ol.geom.Point(ol.proj.fromLonLat([train.lon, train.lat]))
          });

          const style = new ol.style.Style({
            image: new ol.style.Circle({
              radius: 6,
              fill: new ol.style.Fill({ color: 'red' }),
              stroke: new ol.style.Stroke({ color: 'white', width: 2 })
            })
          });

          feature.setStyle(style);

          const vectorSource = new ol.source.Vector({ features: [feature] });
          const vectorLayer = new ol.layer.Vector({ source: vectorSource });
          map.addLayer(vectorLayer);
        });
      })
      .catch(err => {
        console.error("‚ùå Failed to load train data:", err);
      });
  </script>
</body>
</html>
